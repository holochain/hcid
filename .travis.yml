os:
  - osx
  - linux

language: node_js

node_js:
  - 8

cache: cargo

before_install:
  # Install Rust and Cargo
  - curl https://sh.rustup.rs -sSf > /tmp/rustup.sh
  - sh /tmp/rustup.sh -y
  - export PATH="$HOME/.cargo/bin:$PATH"
  - source "$HOME/.cargo/env"

before_script:
  # Setup xvfb so the browsers can launch
  - "export DISPLAY=:99.0"
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then ( sudo Xvfb :99 -ac -screen 0 1024x768x8; echo ok )& fi
  - if [ "${TRAVIS_OS_NAME}" = "linux" ]; then "sh -e /etc/init.d/xvfb start"; fi
  - sleep 3 # give xvfb some time to start

script:
  - make test
